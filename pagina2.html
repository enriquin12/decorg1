<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Página 2 - Frente</title>

  <!-- PWA / iOS -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <style>
    :root { --vh: 100vh; }
    html,body {
      height:100%;
      margin:0;
      padding:0;
      -webkit-user-select:none;
      user-select:none;
      background:#fff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* fundo fixo (documento) */
    .bg {
      position: fixed;
      inset: 0;
      background-image: url('pagina2.jpeg');
      background-repeat: no-repeat;
      background-position: center top;
      background-size: cover;
      z-index: 0;
      pointer-events: none;
    }

    /* camada UI acima do fundo */
    .ui {
      position: relative;
      z-index: 1;
      min-height: calc(var(--vh));
      width: 100%;
      box-sizing: border-box;
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      padding-bottom: env(safe-area-inset-bottom);
    }

    .hotspot {
      position: absolute;
      background: rgba(255,0,0,0);
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    /* botões superiores */
    #btn-back {
      top: 2.6%;
      left: 3.6%;
      width: 9.2%;
      height: 6.8%;
      min-width:44px;
      min-height:44px;
    }
    #btn-verso {
      top: 5.2%;
      left: 50.5%;
      width: 14.5%;
      height: 6.2%;
      transform: translateX(-8%);
      min-width:44px;
      min-height:44px;
    }

    /* autenticador reposicionado entre a foto do documento e os ícones inferiores
       - left/right iguais para manter mesma distância das laterais
       - bottom definido acima da área dos ícones; ajuste bottom para calibrar verticalmente */
.auth-container {
  position: absolute;
  left: 6%;
  right: 6%;
  bottom: calc(env(safe-area-inset-bottom) + 72px);
  z-index: 2;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 15px;
  color: #000;
  line-height: 1;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}
.auth-container .auth {
  font-weight: 400;
  font-size: 15px;
  pointer-events: none;
}


    /* preserva a antiga last-row como fallback (mantida para compatibilidade) */
    .last-row {
      display: none;
    }

    @media (max-width:360px) {
      #btn-back { top: 3.2%; left: 4.2%; width: 11%; height: 7.6%; }
      #btn-verso { top: 6.2%; left: 51%; width: 17%; height: 7.6%; transform: translateX(-9%); }
      .auth-container { left: 5%; right: 5%; bottom: calc(env(safe-area-inset-bottom) + 56px); font-size: 12px; padding: 7px 10px; }
    }

    @media (min-width:900px) {
      #btn-back, #btn-verso { min-width:56px; min-height:56px; }
      .auth-container { padding: 10px 14px; }
    }
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>

  <div class="ui" role="main" aria-label="Página frente do documento">
    <!-- hotspots -->
    <button id="btn-back" class="hotspot" aria-label="Voltar"></button>
    <button id="btn-verso" class="hotspot" aria-label="Abrir verso"></button>

    <!-- autenticador centralizado entre foto e ícones inferiores -->
    <div class="auth-container" role="status" aria-live="polite" aria-atomic="true">
      <span>Última atualização em:</span>
      <span id="auth-timestamp" class="auth">carregando...</span>
    </div>

    <!-- fallback oculto -->
    <div class="last-row" aria-hidden="true">
      <span>Última atualização em:</span>
      <span id="auth-timestamp-fallback" class="auth">carregando...</span>
    </div>
  </div>

  <script>
    // Corrige 100vh no iOS
    function setVh(){ document.documentElement.style.setProperty('--vh', (window.innerHeight || document.documentElement.clientHeight) + 'px'); }
    setVh(); window.addEventListener('resize', setVh);

    // Helpers para timestamp
    function two(n){ return n < 10 ? '0' + n : String(n); }
    function buildTimestamp(date){
      const d = two(date.getDate());
      const m = two(date.getMonth() + 1);
      const y = String(date.getFullYear()).slice(-2);
      const hh = two(date.getHours());
      const mm = two(date.getMinutes());
      return `${d}/${m}/${y} - ${hh}:${mm}`;
    }
    function setAuthTimestamp(){
      const el = document.getElementById('auth-timestamp');
      const fb = document.getElementById('auth-timestamp-fallback');
      if(el) el.textContent = buildTimestamp(new Date());
      if(fb) fb.textContent = buildTimestamp(new Date());
    }

    // Navegação relativa usando location.assign (mantém contexto standalone)
    (function(){
      const back = document.getElementById('btn-back');
      if(back){
        back.addEventListener('click', function(e){
          e.preventDefault();
          location.assign('index.html');
        }, {passive:false});
      }
      const verso = document.getElementById('btn-verso');
      if(verso){
        verso.addEventListener('click', function(e){
          e.preventDefault();
          location.assign('pagina3.html');
        }, {passive:false});
      }
    })();

    // Inicializa timestamp
    window.addEventListener('load', function(){
      setAuthTimestamp();
      // opcional: atualizar a cada minuto
      // window.setInterval(setAuthTimestamp, 60000);
    });

    // Debug: checar se abriu em modo standalone
    (function(){ const isStandalone = window.navigator.standalone || window.matchMedia('(display-mode: standalone)').matches; console.info('Standalone?', isStandalone); })();

    // Registra service worker opcional (caminho relativo para GitHub Pages)
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js').catch(()=>{/* não crítico */});
    }
  </script>
</body>
</html>
